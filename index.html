<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì‚¬ê´€ë¦¬ í”„ë¡œê·¸ë¨</title>
    
    <!-- ìºì‹œ ë°©ì§€ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- PWA ì„¤ì • -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <!-- ë²„ì „ ê´€ë¦¬ -->
    <meta name="version" content="2.0.0">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: white;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .container {
            width: 100%;
            height: 100vh;
            margin: 0;
            background: white;
            overflow: auto;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .header p {
            margin: 0;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .firebase-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .firebase-status.connected {
            background: #4caf50;
            color: white;
        }

        .firebase-status.disconnected {
            background: #f44336;
            color: white;
        }

        .firebase-status.loading {
            background: #ff9800;
            color: white;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .form-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .action-btns {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 5px;
            font-size: 14px;
        }

        .low-stock {
            background: #ffebee !important;
        }

        .completed-item {
            text-decoration: line-through;
            text-decoration-color: #f44336;
            text-decoration-thickness: 2px;
            opacity: 0.7;
        }

        .checkbox-cell {
            text-align: center;
        }

        .checkbox-cell input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Firebase ì—°ê²° ìƒíƒœ -->
    <div class="firebase-status loading" id="firebase-status">
        <span>â—</span> ì—°ê²° ì¤‘...
    </div>

    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ ê³µì‚¬ê´€ë¦¬ í”„ë¡œê·¸ë¨ (Firebase ì‹¤ì‹œê°„ ë™ê¸°í™”)</h1>
            <p>ìì¬ ê´€ë¦¬ ë° ì—…ë¬´ í˜„í™© í†µí•© ì‹œìŠ¤í…œ <span style="font-size: 0.8em; opacity: 0.7; margin-left: 10px;">v2.0.0</span></p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
            <button class="tab" onclick="showTab('notices')">ğŸ“¢ ê³µì§€ì‚¬í•­</button>
            <button class="tab" onclick="showTab('team-status')">ğŸ‘¥ íŒ€ë³„ ì—…ë¬´í˜„í™©</button>
            <button class="tab" onclick="showTab('materials')">ğŸ“¦ ìì¬ ëª©ë¡</button>
            <button class="tab" onclick="showTab('incoming')">ğŸ“¥ ì…ê³  ê´€ë¦¬</button>
            <button class="tab" onclick="showTab('outgoing')">ğŸ“¤ ì‚¬ìš©(ì¶œê³ ) ê´€ë¦¬</button>
            <button class="tab" onclick="showTab('history')">ğŸ“‹ ì „ì²´ ë‚´ì—­</button>
        </div>

        <!-- ëŒ€ì‹œë³´ë“œ íƒ­ -->
        <div id="dashboard" class="tab-content active">
            <div class="alert" id="dashboard-alert"></div>
            
            <div class="stats-container">
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>ğŸ“¢ ê³µì§€ì‚¬í•­ (ìµœê·¼ 5ê°œ)</h3>
                    <div id="notice-list" style="margin-top: 15px; max-height: 200px; overflow-y: auto;">
                        <p style="text-align: center; color: rgba(255,255,255,0.7); padding: 20px;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                    <button onclick="showTab('notices'); event.stopPropagation();" class="btn btn-primary" style="margin-top: 10px; width: 100%; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">ê³µì§€ì‚¬í•­ ê´€ë¦¬</button>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>ğŸ‘¥ íŒ€ë³„ ì—…ë¬´í˜„í™© (ìµœê·¼ 5ê°œ)</h3>
                    <div id="team-status-list" style="margin-top: 15px; max-height: 200px; overflow-y: auto;">
                        <p style="text-align: center; color: rgba(255,255,255,0.7); padding: 20px;">ë“±ë¡ëœ ì—…ë¬´í˜„í™©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                    <button onclick="showTab('team-status'); event.stopPropagation();" class="btn btn-primary" style="margin-top: 10px; width: 100%; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">ì—…ë¬´í˜„í™© ê´€ë¦¬</button>
                </div>
            </div>

            <h2 style="margin-bottom: 15px;">ğŸ“‹ ìì¬ í˜„í™©</h2>
            <div class="table-container">
                <table id="low-stock-table">
                    <thead>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>í’ˆëª…</th>
                            <th>ê·œê²©</th>
                            <th>ë‹¨ìœ„</th>
                            <th>ê³„ì•½ìˆ˜ëŸ‰</th>
                            <th>ì…ê³ ìˆ˜ëŸ‰</th>
                            <th>ì‚¬ìš©ìˆ˜ëŸ‰</th>
                            <th>ì”ì—¬ìˆ˜ëŸ‰</th>
                            <th>ë¶€ì¡±ë¥ </th>
                            <th>ë¹„ê³ </th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- ê³µì§€ì‚¬í•­ íƒ­ -->
        <div id="notices" class="tab-content">
            <div class="alert" id="notices-alert"></div>
            
            <div class="form-section">
                <h2 style="margin-bottom: 15px;">ğŸ“¢ ê³µì§€ì‚¬í•­ ë“±ë¡</h2>
                <form id="notice-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì œëª© *</label>
                            <input type="text" id="notice-title" required>
                        </div>
                        <div class="form-group">
                            <label>ì‘ì„±ì¼ *</label>
                            <input type="date" id="notice-date" required>
                        </div>
                        <div class="form-group">
                            <label>ì™„ë£Œê¸°í•œ</label>
                            <input type="date" id="notice-deadline">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ë‚´ìš© *</label>
                            <textarea id="notice-content" required style="min-height: 100px;"></textarea>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ê³µì§€ì‚¬í•­ ë“±ë¡</button>
                        <button type="button" class="btn btn-warning" onclick="resetNoticeForm()">ì´ˆê¸°í™”</button>
                    </div>
                </form>
            </div>

            <div class="search-box">
                <input type="text" id="notice-search" placeholder="ğŸ” ì œëª©, ë‚´ìš©ìœ¼ë¡œ ê²€ìƒ‰..." onkeyup="searchNotices()">
            </div>

            <div class="table-container">
                <table id="notices-table">
                    <thead>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>ì™„ë£Œ</th>
                            <th>ì œëª©</th>
                            <th>ë‚´ìš©</th>
                            <th>ì‘ì„±ì¼</th>
                            <th>ì™„ë£Œê¸°í•œ</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- íŒ€ë³„ ì—…ë¬´í˜„í™© íƒ­ -->
        <div id="team-status" class="tab-content">
            <div class="alert" id="team-status-alert"></div>
            
            <div class="form-section">
                <h2 style="margin-bottom: 15px;">ğŸ‘¥ íŒ€ë³„ ì—…ë¬´í˜„í™© ë“±ë¡</h2>
                <form id="team-status-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>íŒ€ëª… *</label>
                            <input type="text" id="team-name" required>
                        </div>
                        <div class="form-group">
                            <label>ì‘ì„±ì¼ *</label>
                            <input type="date" id="team-date" required>
                        </div>
                        <div class="form-group">
                            <label>ì™„ë£Œê¸°í•œ</label>
                            <input type="date" id="team-deadline">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì—…ë¬´ë‚´ìš© *</label>
                            <textarea id="team-content" required style="min-height: 100px;"></textarea>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">ì—…ë¬´í˜„í™© ë“±ë¡</button>
                        <button type="button" class="btn btn-warning" onclick="resetTeamStatusForm()">ì´ˆê¸°í™”</button>
                    </div>
                </form>
            </div>

            <div class="search-box">
                <input type="text" id="team-status-search" placeholder="ğŸ” íŒ€ëª…, ì—…ë¬´ë‚´ìš©ìœ¼ë¡œ ê²€ìƒ‰..." onkeyup="searchTeamStatus()">
            </div>

            <div class="table-container">
                <table id="team-status-table">
                    <thead>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>ì™„ë£Œ</th>
                            <th>íŒ€ëª…</th>
                            <th>ì—…ë¬´ë‚´ìš©</th>
                            <th>ì‘ì„±ì¼</th>
                            <th>ì™„ë£Œê¸°í•œ</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- ìì¬ ëª©ë¡ íƒ­ (ê°„ë‹¨ ë²„ì „ - ë‚˜ë¨¸ì§€ íƒ­ë“¤ë„ ë™ì¼í•œ êµ¬ì¡°) -->
        <div id="materials" class="tab-content">
            <div class="alert" id="materials-alert"></div>
            <h2>ìì¬ ëª©ë¡ ê´€ë¦¬</h2>
            <p style="color: #666; margin: 20px 0;">Firebase ì—°ë™ ë²„ì „ì—ì„œëŠ” ìì¬ ê´€ë¦¬ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div id="incoming" class="tab-content">
            <div class="alert" id="incoming-alert"></div>
            <h2>ì…ê³  ê´€ë¦¬</h2>
            <p style="color: #666; margin: 20px 0;">Firebase ì—°ë™ ë²„ì „ì—ì„œëŠ” ì…ê³  ê´€ë¦¬ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div id="outgoing" class="tab-content">
            <div class="alert" id="outgoing-alert"></div>
            <h2>ì‚¬ìš©(ì¶œê³ ) ê´€ë¦¬</h2>
            <p style="color: #666; margin: 20px 0;">Firebase ì—°ë™ ë²„ì „ì—ì„œëŠ” ì¶œê³  ê´€ë¦¬ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div id="history" class="tab-content">
            <div class="alert" id="history-alert"></div>
            <h2>ì „ì²´ ë‚´ì—­</h2>
            <p style="color: #666; margin: 20px 0;">Firebase ì—°ë™ ë²„ì „ì—ì„œëŠ” ì „ì²´ ë‚´ì—­ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // ========================================
        // ğŸ”¥ Firebase ì„¤ì •
        // ========================================
        const firebaseConfig = {
            apiKey: "AIzaSyBQrZ3fxpjXAXT8i991iUReu-YnMYGN8jU",
            authDomain: "sy1bl-31462.firebaseapp.com",
            databaseURL: "https://sy1bl-31462-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "sy1bl-31462",
            storageBucket: "sy1bl-31462.firebasestorage.app",
            messagingSenderId: "823520271852",
            appId: "1:823520271852:web:21b1d3239d6916f79174c9",
            measurementId: "G-8CXK5921NF"
        };

        // Firebase ì´ˆê¸°í™”
        let database;
        let isFirebaseConnected = false;

        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            
            // ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§
            const connectedRef = database.ref('.info/connected');
            connectedRef.on('value', (snapshot) => {
                if (snapshot.val() === true) {
                    updateFirebaseStatus('connected');
                    isFirebaseConnected = true;
                } else {
                    updateFirebaseStatus('disconnected');
                    isFirebaseConnected = false;
                }
            });
            
        } catch (error) {
            console.error('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            updateFirebaseStatus('disconnected');
            alert('Firebase ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”. firebaseConfig ì •ë³´ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•˜ì…¨ë‚˜ìš”?');
        }

        // Firebase ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateFirebaseStatus(status) {
            const statusEl = document.getElementById('firebase-status');
            statusEl.className = `firebase-status ${status}`;
            
            if (status === 'connected') {
                statusEl.innerHTML = '<span>â—</span> ì—°ê²°ë¨';
            } else if (status === 'disconnected') {
                statusEl.innerHTML = '<span>â—</span> ì—°ê²° ëŠê¹€';
            } else {
                statusEl.innerHTML = '<span>â—</span> ì—°ê²° ì¤‘...';
            }
        }

        // ë°ì´í„° ì €ì¥ì†Œ (Firebase ë™ê¸°í™”)
        let notices = [];
        let teamStatuses = [];

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            setTodayDate();
            setupFirebaseListeners();
            loadAllData();
        });

        // Firebase ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupFirebaseListeners() {
            // ê³µì§€ì‚¬í•­ ì‹¤ì‹œê°„ ë™ê¸°í™”
            database.ref('notices').on('value', (snapshot) => {
                const data = snapshot.val();
                notices = data ? Object.values(data) : [];
                loadNotices();
                loadDashboardNotices();
            });

            // íŒ€ë³„ ì—…ë¬´í˜„í™© ì‹¤ì‹œê°„ ë™ê¸°í™”
            database.ref('teamStatuses').on('value', (snapshot) => {
                const data = snapshot.val();
                teamStatuses = data ? Object.values(data) : [];
                loadTeamStatuses();
                loadDashboardTeamStatuses();
            });
        }

        // ë‚ ì§œ ì´ˆê¸°í™”
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            if (document.getElementById('notice-date')) {
                document.getElementById('notice-date').value = today;
            }
            if (document.getElementById('team-date')) {
                document.getElementById('team-date').value = today;
            }
        }

        // íƒ­ ì „í™˜
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            const clickedTab = Array.from(tabs).find(tab => 
                tab.getAttribute('onclick') && tab.getAttribute('onclick').includes(tabName)
            );
            if (clickedTab) clickedTab.classList.add('active');
            
            document.getElementById(tabName).classList.add('active');
        }

        // ê³µì§€ì‚¬í•­ ë“±ë¡
        document.getElementById('notice-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const notice = {
                id: Date.now(),
                title: document.getElementById('notice-title').value,
                content: document.getElementById('notice-content').value,
                date: document.getElementById('notice-date').value,
                deadline: document.getElementById('notice-deadline').value || '',
                completed: false
            };
            
            // Firebaseì— ì €ì¥
            database.ref('notices/' + notice.id).set(notice)
                .then(() => {
                    showAlert('notices-alert', 'ê³µì§€ì‚¬í•­ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    resetNoticeForm();
                })
                .catch((error) => {
                    showAlert('notices-alert', 'ë“±ë¡ ì‹¤íŒ¨: ' + error.message, 'error');
                });
        });

        // íŒ€ë³„ ì—…ë¬´í˜„í™© ë“±ë¡
        document.getElementById('team-status-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const teamStatus = {
                id: Date.now(),
                teamName: document.getElementById('team-name').value,
                content: document.getElementById('team-content').value,
                date: document.getElementById('team-date').value,
                deadline: document.getElementById('team-deadline').value || '',
                completed: false
            };
            
            // Firebaseì— ì €ì¥
            database.ref('teamStatuses/' + teamStatus.id).set(teamStatus)
                .then(() => {
                    showAlert('team-status-alert', 'íŒ€ë³„ ì—…ë¬´í˜„í™©ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    resetTeamStatusForm();
                })
                .catch((error) => {
                    showAlert('team-status-alert', 'ë“±ë¡ ì‹¤íŒ¨: ' + error.message, 'error');
                });
        });

        // ê³µì§€ì‚¬í•­ ëª©ë¡ ë¡œë“œ
        function loadNotices() {
            const tbody = document.getElementById('notices-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            const sortedNotices = [...notices].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedNotices.forEach((notice, index) => {
                const row = tbody.insertRow();
                const completedClass = notice.completed ? 'completed-item' : '';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="checkbox-cell">
                        <input type="checkbox" ${notice.completed ? 'checked' : ''} 
                               onchange="toggleNoticeComplete(${notice.id})">
                    </td>
                    <td class="${completedClass}">${notice.title}</td>
                    <td class="${completedClass}" style="max-width: 300px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${notice.content}</td>
                    <td class="${completedClass}">${notice.date}</td>
                    <td class="${completedClass}">${notice.deadline || '-'}</td>
                    <td class="action-btns">
                        <button class="action-btn btn-danger" onclick="deleteNotice(${notice.id})">ì‚­ì œ</button>
                    </td>
                `;
            });
            
            if (notices.length === 0) {
                const row = tbody.insertRow();
                row.innerHTML = '<td colspan="7" style="text-align: center; padding: 30px;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td>';
            }
        }

        // íŒ€ë³„ ì—…ë¬´í˜„í™© ëª©ë¡ ë¡œë“œ
        function loadTeamStatuses() {
            const tbody = document.getElementById('team-status-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            const sortedStatuses = [...teamStatuses].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedStatuses.forEach((status, index) => {
                const row = tbody.insertRow();
                const completedClass = status.completed ? 'completed-item' : '';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="checkbox-cell">
                        <input type="checkbox" ${status.completed ? 'checked' : ''} 
                               onchange="toggleTeamStatusComplete(${status.id})">
                    </td>
                    <td class="${completedClass}">${status.teamName}</td>
                    <td class="${completedClass}" style="max-width: 300px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${status.content}</td>
                    <td class="${completedClass}">${status.date}</td>
                    <td class="${completedClass}">${status.deadline || '-'}</td>
                    <td class="action-btns">
                        <button class="action-btn btn-danger" onclick="deleteTeamStatus(${status.id})">ì‚­ì œ</button>
                    </td>
                `;
            });
            
            if (teamStatuses.length === 0) {
                const row = tbody.insertRow();
                row.innerHTML = '<td colspan="7" style="text-align: center; padding: 30px;">ë“±ë¡ëœ ì—…ë¬´í˜„í™©ì´ ì—†ìŠµë‹ˆë‹¤.</td>';
            }
        }

        // ëŒ€ì‹œë³´ë“œì— ê³µì§€ì‚¬í•­ í‘œì‹œ
        function loadDashboardNotices() {
            const noticeList = document.getElementById('notice-list');
            const sortedNotices = [...notices].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            
            if (sortedNotices.length === 0) {
                noticeList.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.7); padding: 20px;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            } else {
                noticeList.innerHTML = sortedNotices.map(notice => {
                    const completedStyle = notice.completed ? 'text-decoration: line-through; text-decoration-color: #ff0000; opacity: 0.7;' : '';
                    const deadlineText = notice.deadline ? `<div style="font-size: 11px; opacity: 0.7;">ê¸°í•œ: ${notice.deadline}</div>` : '';
                    
                    return `
                    <div style="background: rgba(255,255,255,0.2); padding: 10px; margin-bottom: 8px; border-radius: 5px; border-left: 3px solid white;">
                        <div style="font-weight: bold; margin-bottom: 5px; ${completedStyle}">${notice.completed ? 'âœ… ' : ''}${notice.title}</div>
                        <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; ${completedStyle}">${notice.content}</div>
                        <div style="font-size: 11px; opacity: 0.7;">ì‘ì„±: ${notice.date}</div>
                        ${deadlineText}
                    </div>
                `;
                }).join('');
            }
        }

        // ëŒ€ì‹œë³´ë“œì— íŒ€ë³„ ì—…ë¬´í˜„í™© í‘œì‹œ
        function loadDashboardTeamStatuses() {
            const teamStatusList = document.getElementById('team-status-list');
            const sortedStatuses = [...teamStatuses].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            
            if (sortedStatuses.length === 0) {
                teamStatusList.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.7); padding: 20px;">ë“±ë¡ëœ ì—…ë¬´í˜„í™©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            } else {
                teamStatusList.innerHTML = sortedStatuses.map(status => {
                    const completedStyle = status.completed ? 'text-decoration: line-through; text-decoration-color: #ff0000; opacity: 0.7;' : '';
                    const deadlineText = status.deadline ? `<div style="font-size: 11px; opacity: 0.7;">ê¸°í•œ: ${status.deadline}</div>` : '';
                    
                    return `
                    <div style="background: rgba(255,255,255,0.2); padding: 10px; margin-bottom: 8px; border-radius: 5px; border-left: 3px solid white;">
                        <div style="font-weight: bold; margin-bottom: 5px; ${completedStyle}">${status.completed ? 'âœ… ' : ''}${status.teamName}</div>
                        <div style="font-size: 12px; opacity: 0.9; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; ${completedStyle}">${status.content}</div>
                        <div style="font-size: 11px; opacity: 0.7;">ì‘ì„±: ${status.date}</div>
                        ${deadlineText}
                    </div>
                `;
                }).join('');
            }
        }

        // ê³µì§€ì‚¬í•­ ì™„ë£Œ í† ê¸€
        function toggleNoticeComplete(id) {
            const notice = notices.find(n => n.id === id);
            if (notice) {
                database.ref('notices/' + id).update({
                    completed: !notice.completed
                });
            }
        }

        // íŒ€ë³„ ì—…ë¬´í˜„í™© ì™„ë£Œ í† ê¸€
        function toggleTeamStatusComplete(id) {
            const status = teamStatuses.find(t => t.id === id);
            if (status) {
                database.ref('teamStatuses/' + id).update({
                    completed: !status.completed
                });
            }
        }

        // ê³µì§€ì‚¬í•­ ì‚­ì œ
        function deleteNotice(id) {
            if (!confirm('ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            database.ref('notices/' + id).remove()
                .then(() => {
                    showAlert('notices-alert', 'ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                })
                .catch((error) => {
                    showAlert('notices-alert', 'ì‚­ì œ ì‹¤íŒ¨: ' + error.message, 'error');
                });
        }

        // íŒ€ë³„ ì—…ë¬´í˜„í™© ì‚­ì œ
        function deleteTeamStatus(id) {
            if (!confirm('ì´ ì—…ë¬´í˜„í™©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            database.ref('teamStatuses/' + id).remove()
                .then(() => {
                    showAlert('team-status-alert', 'ì—…ë¬´í˜„í™©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                })
                .catch((error) => {
                    showAlert('team-status-alert', 'ì‚­ì œ ì‹¤íŒ¨: ' + error.message, 'error');
                });
        }

        // í¼ ì´ˆê¸°í™”
        function resetNoticeForm() {
            document.getElementById('notice-form').reset();
            setTodayDate();
        }

        function resetTeamStatusForm() {
            document.getElementById('team-status-form').reset();
            setTodayDate();
        }

        // ê²€ìƒ‰ ê¸°ëŠ¥
        function searchNotices() {
            const searchText = document.getElementById('notice-search').value.toLowerCase();
            const rows = document.getElementById('notices-table').getElementsByTagName('tbody')[0].rows;
            
            Array.from(rows).forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchText) ? '' : 'none';
            });
        }

        function searchTeamStatus() {
            const searchText = document.getElementById('team-status-search').value.toLowerCase();
            const rows = document.getElementById('team-status-table').getElementsByTagName('tbody')[0].rows;
            
            Array.from(rows).forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchText) ? '' : 'none';
            });
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            alert.textContent = message;
            alert.className = `alert ${type}`;
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 3000);
        }

        // ëª¨ë“  ë°ì´í„° ë¡œë“œ
        function loadAllData() {
            loadNotices();
            loadTeamStatuses();
            loadDashboardNotices();
            loadDashboardTeamStatuses();
        }
    </script>
</body>
</html>
